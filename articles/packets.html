<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
    
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Packets | Parcel </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Packets | Parcel ">
      <meta name="generator" content="docfx 2.59.3.0">
      
      <link rel="shortcut icon" href="../images/favicon.png">
      <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/night-owl.min.css">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" integrity="sha384-EvBWSlnoFgZlXJvpzS+MAUEjvN7+gcCwH+qh7GRFOGgZO0PuwOFro7qPOJnLfe7l" crossorigin="anonymous">
      <link rel="stylesheet" href="../styles/config.css">
      <link rel="stylesheet" href="../styles/discord.css">
      <link rel="stylesheet" href="../styles/singulink.css">
      <link rel="stylesheet" href="../styles/main.css">
      <meta property="docfx:navrel" content="../toc.html">
      <meta property="docfx:tocrel" content="toc.html">
      
      <meta property="docfx:rel" content="../">
      <meta property="docfx:newtab" content="true">
    </head>
    <body>
        <div class="top-navbar">
            <a class="burger-icon" onclick="toggleMenu()">
                <svg name="Hamburger" style="vertical-align: middle;" width="34" height="34" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M20 6H4V9H20V6ZM4 10.999H20V13.999H4V10.999ZM4 15.999H20V18.999H4V15.999Z"></path></svg>
            </a>

            
            <a class="brand" href="../index.html">
              <img src="../images/logo.png" alt="Parcel Packet Manager" class="logomark">
              <span class="brand-title">Parcel Packet Manager</span>
            </a>        </div>

        <div class="body-content">
            <div id="blackout" class="blackout" onclick="toggleMenu()"></div>

            <nav id="sidebar" role="navigation">
                <div class="sidebar">
                    
                    <div>
                      <div class="mobile-hide">
                        
                        <a class="brand" href="../index.html">
                          <img src="../images/logo.png" alt="Parcel Packet Manager" class="logomark">
                          <span class="brand-title">Parcel Packet Manager</span>
                        </a>  </div>
                    
                      <div class="sidesearch">
                        <form id="search" role="search" class="search">
                            <i class="bi bi-search search-icon"></i>
                            <input type="text" id="search-query" placeholder="Search" autocomplete="off">
                        </form>
                      </div>
                    
                      <div id="navbar">
                      </div>
                    </div>                    <div class="sidebar-item-separator"></div>
                        
                        <div id="sidetoggle">
                          <div id="sidetoc"></div>
                        </div>
                </div>
                <div class="footer">
                  <strong>Parcel Packet Manager</strong>
                  
                </div>            </nav>

            <main class="main-panel">
                
                <div id="search-results" style="display: none;">
                  <h1 class="search-list">Search Results for <span></span></h1>
                  <div class="sr-items">
                    <p><i class="bi bi-hourglass-split index-loading"></i></p>
                  </div>
                  <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
                </div>
                <div role="main" class="hide-when-search">
                        
                        <div class="subnav navbar navbar-default">
                          <div class="container hide-when-search" id="breadcrumb">
                            <ul class="breadcrumb">
                              <li></li>
                            </ul>
                          </div>
                        </div>

                    <article class="content wrap" id="_content" data-uid="">

<style>
    h1.title {
        text-align: center;
        font-size: 3rem;
    }
    h3 {
        font-size: 1.5rem;
    }
</style>
<h1 class="title">Packets</h1>
<p>In Parcel, Packets are standard c# object that inherit from the Packet class. Packets can contain any type of data from primitives to complex objects. It is recommended to keep most Packets lightweight, especially those that are sent very often.</p>
<h2>Defining a Packet</h2>
<p>When defining a Packet in your project, you should create a new class that extends from the Packet class. It is highly recommended that you implement a default parameterless constructor into your Packet on top of any other constructors you create, especially if your Packet has fields that need to be initialized in the constructor. Packets lacking a default parameterless constructor will still be constructed, however, their behavior is not predictable and a Warning will be thrown when one is created.</p>
<pre><code class="lang-cs">public class MyPacket : Packet
{
    public MyPacket() { }
}
</code></pre>
<h2>Serialization</h2>
<p>The data within a packet that you wish to have sent must be in the form of a c# Property with a getter and a setter. Fields will not be serialized.</p>
<p>example:</p>
<pre><code class="lang-cs">public string MyProperty { get; set; }
</code></pre>
<p>By default, properties will be serialized when a packet is sent. If you wish for a property to not be sent, you can add the Ignore attribute to the property.</p>
<pre><code class="lang-cs">[Ignore]
public string MyProperty { get; set; }
</code></pre>
<p>You can also flip the default behavior of the serializer so that properties need to be explicitly marked for serialization using the OptIn attribute on the Packet itself and the Serialize attribute on the property.</p>
<pre><code class="lang-cs">[OptIn]
public class MyPacket : Packet
{
    [Serialize]
    public string MyProperty { get; set;}
}
</code></pre>
<h2>Included Properties</h2>
<p>Packets contain five included properties that are in place to support any logic that could be included in the Packet. These properties do not serialize with each Packet.</p>
<ul>
<li>Peer Sender - The Peer that sent this Packet.</li>
<li>IsServer - Whether this Packet was received by a server or client.</li>
<li>IsClient - Whether this Packet was received by a client or server.</li>
<li>Client - The ParcelClient that received this Packet. Null if IsClient is false.</li>
<li>Server - The ParcelServer that received this Packet. Null if IsServer is false.</li>
</ul>
<h2>Virtual Methods</h2>
<p>Packets also provide a few virtual methods that you can override to add logic to your packets.</p>
<ul>
<li>bool CanSend() - Allows for logic to be performed before serialization to determine if the Packet should be sent. Return true to send this Packet.</li>
<li>void OnSend() - Allows for logic to be performed shortly before serialization. This is only called if CanSend returned true.</li>
<li>void OnReceive() - Allows for logic to be performed shortly after deserialization.</li>
</ul>
<p>A Note of thread-safety:</p>
<p>By default, these methods are called from a worker thread. Ensure any code you write within these methods is thread-safe. If you want these methods to be called on a thread of your choosing, there is a option available in the ParcelSettings class that disables automatic updates for the client or server.</p>
<h2>Built-in Packet Types</h2>
<p>There are two additional built-in Packet types for you to use. These Packets simply enforce sending a Packet in a single direction.</p>
<ul>
<li>ServerToClientPacket - A Packet that can only travel from a Server to a Client.</li>
<li>ClientToServerPacket - A Packet that can only travel from a Client to a Server.</li>
</ul>
<p>If you wish to implement your own logic in the CanSend() virtual method within these Packets, ensure you call base.CanSend() or they will lose their functionality.</p>
<pre><code class="lang-cs">protected override void CanSend() 
{
    return base.CanSend() &amp;&amp; MyCondition;
}
</code></pre>
<h2>Example</h2>
<p>An example of a Packet that performs a weapon firing action on the server:</p>
<pre><code class="lang-cs">public sealed class FireWeaponPacket : ClientToServerPacket
{
    public Vector3 Ray { get; private set; }
    public string WeaponID { get; private set; }

    public FireWeaponPacket() { }

    public FireWeaponPacket(Vector3 ray, string weaponID)
    {
        this.Ray = ray;
        this.WeaponID = weaponID;
    }

    protected override void OnReceive()
    {
        if (WeaponsManifest.TryGetWeapon(this.WeaponID, out Weapon weapon))
        {
            if (World.PerformHitscan(this.Ray, out Entity hit))
            {
                hit.Damage(weapon);
            }
        }
    }
}
</code></pre>
</article>
                </div>

                <div class="copyright-footer">
                    <span>&#65533; Teegan Krieger. All rights reserved.</span>
                </div>
            </main>
        </div>

        
        <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
        <script type="text/javascript" src="../styles/jquery.twbsPagination.js"></script>
        <script type="text/javascript" src="../styles/url.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
        <script type="text/javascript" src="../styles/docfx.js"></script>
        <script type="text/javascript" src="../styles/singulink.js"></script>
        <script type="text/javascript" src="../styles/main.js"></script>    </body>
</html>
